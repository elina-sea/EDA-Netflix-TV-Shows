---
title: "SECOND HAND CARS DATA SET"
output:
  html_document:
    df_print: paged
editor_options: 
  chunk_output_type: inline
---
#### comment
  Written with some trivial explanations and conclusions in order go through the process of explaining everything to myself for remembering objects better.

---
# Part 1

  This is an R Notebook containing the analysis of 1000 cars on second-hand market. Data set was obtained from [Kaggle]https://www.kaggle.com/mayankpatel14/second-hand-used-cars-data-set-linear-regression).
  
  Description from author:
  This is a dataset that can be used to apply regression algorithms for beginners. There are no missing value and the data set is small too.
  The data set gives the second hand price of cars and its features like:
  
- v.id
- on road old
- on road now
- years
- km
- rating
- condition
- economy
- top speed
- hp
- torque
- current price
  
  Let's start with observing what types of variables there are in this data set:

```{r echo = FALSE}
library(readr)
library(ggplot2)
#read in the dataset
cars <- read_csv("cars.csv")
```

  As we can observe this data set has only quantitative variables and they all are represented by numeric values of type double.
  
#### Reasoning for using this data set
  Some of the tasks to be performed and aspects to be explored:
  
### Analysing missing values 

```{r message=FALSE, paged.print=FALSE, echo=FALSE}
library(naniar)
#plot missing values with naniar pkg which is based on ggplot2
gg_miss_var(cars)
```

  As we can see, there are no missing values in this data set. This means we can compute further relations without complications.
  
## Now let's have fun and explore distribution of each parameter individually

  On the following graphs distribution of each parameter among all star types is shown.
  
  
```{r message=FALSE, warning=FALSE, echo=FALSE}
library(cowplot)
library(dplyr)
library(hrbrthemes)

km <- c(cars$km)
years <- c(cars$years)
rating <- c(cars$rating)
`condition rating` <- c(cars$condition)
discount <- c(cars$economy)
mph <- c(cars$`top speed`)
hp <- c(cars$hp)
torque <- c(cars$torque)
price <- c(cars$`current price`)

df_cars <- data.frame(cars)

ggplot(df_cars, aes(km)) + geom_histogram(aes(y = ..density..)) + 
  geom_density(fill="#69b3a2", color="#e9ecef", alpha=0.2) +
  ggtitle("Distribution of car mileage") +
  theme_ipsum()
ggplot(df_cars, aes(years)) + geom_histogram(aes(y = ..density..)) + 
  geom_density(fill="#69b3a2", color="#e9ecef", alpha=0.2) +
  ggtitle("Distribution of car age") +
  theme_ipsum()
ggplot(df_cars, aes(rating)) + geom_histogram(aes(y = ..density..)) + 
  geom_density(fill="#69b3a2", color="#e9ecef", alpha=0.2) +
  ggtitle("Distribution of car rating from 1 to 5") +
  theme_ipsum()
ggplot(df_cars, aes(`condition rating`)) + geom_histogram(aes(y = ..density..)) + 
  geom_density(fill="#69b3a2", color="#e9ecef", alpha=0.2) +
  ggtitle("Distribution of car condition rating from 1 to 10") +
  theme_ipsum()
ggplot(df_cars, aes(discount)) + geom_histogram(aes(y = ..density..)) + 
  geom_density(fill="#69b3a2", color="#e9ecef", alpha=0.2) +
  ggtitle("Distribution of sale for car in %") +
  theme_ipsum()
ggplot(df_cars, aes(mph)) + geom_histogram(aes(y = ..density..)) + 
  geom_density(fill="#69b3a2", color="#e9ecef", alpha=0.2) +
  ggtitle("Distribution of car maximum speed in miles/hour") +
  theme_ipsum()
ggplot(df_cars, aes(torque)) + geom_histogram(aes(y = ..density..)) + 
  geom_density(fill="#69b3a2", color="#e9ecef", alpha=0.2) +
  ggtitle("Distribution of car torque") +
  theme_ipsum()
ggplot(df_cars, aes(price)) + geom_histogram(aes(y = ..density..)) + 
  geom_density(fill="#69b3a2", color="#e9ecef", alpha=0.2) +
  ggtitle("Distribution of car price") +
  theme_ipsum()


```

### Summary on distribution graphs

  From the distributions graphs above we can conclude:
  - there is approximately even ratio between amount of cars for each rating and "age" of a car
  - most of the cars have middle price rather than low or high
  
  Speaking of graphs themselves, there are no skewed graphs - rather multimodal. Car price distribution looks close to normal bell-shaped distribution.
  
---  
# Part 2
  
  In this part we will concentrate on examining each parameter separately.
  
### Mean values
#### Mean of mileage
```{r  message=FALSE, warning=FALSE, echo=FALSE}
library(ggplot2)

mean(km)
```
#### Mean of car age
```{r  message=FALSE, warning=FALSE, echo=FALSE}
library(ggplot2)

mean(years)
```
#### Mean of rating
```{r  message=FALSE, warning=FALSE, echo=FALSE}
library(ggplot2)

mean(rating)
```
#### Mean of condition rating
```{r  message=FALSE, warning=FALSE, echo=FALSE}
library(ggplot2)

mean(`condition rating`)
```
#### Mean of given discount
```{r  message=FALSE, warning=FALSE, echo=FALSE}
library(ggplot2)

mean(discount)
```
#### Mean of maximum speed
```{r  message=FALSE, warning=FALSE, echo=FALSE}
library(ggplot2)

mean(mph)
```
#### Mean of torque
```{r  message=FALSE, warning=FALSE, echo=FALSE}
library(ggplot2)

mean(torque)
```
#### Mean of price
```{r  message=FALSE, warning=FALSE, echo=FALSE}
library(ggplot2)

mean(price)
```

---


### Mode values
#### Mode of mileage
```{r message=FALSE, warning=FALSE, echo=FALSE}
library(DescTools)

Mode(km)
```
#### Mode of car age
```{r message=FALSE, warning=FALSE, echo=FALSE}
library(DescTools)

Mode(years)
```
#### Mode of rating
```{r message=FALSE, warning=FALSE, echo=FALSE}
library(DescTools)

Mode(rating)
```
#### Mode of condition rating
```{r message=FALSE, warning=FALSE, echo=FALSE}
library(DescTools)

Mode(`condition rating`)
```
#### Mode of discount given
```{r message=FALSE, warning=FALSE, echo=FALSE}
library(DescTools)

Mode(discount)
```
#### Mode of maximum speed
```{r message=FALSE, warning=FALSE, echo=FALSE}
library(DescTools)

Mode(mph)
```
#### Mode of maximum torque
```{r message=FALSE, warning=FALSE, echo=FALSE}
library(DescTools)

Mode(torque)
```
#### Mode of maximum price
```{r message=FALSE, warning=FALSE, echo=FALSE}
library(DescTools)

Mode(price)
```


  Let's discuss mode a bit. As we can see, the result went a bit off for mileage mode. But actually it's not off but rather demonstrates some of the "disadvantages" of mode:
    - mode is unstable when the data consist of a small number of values;
    - data can have more than one mode or no mode at all;
  Though it is often considered to be a disadvantage, it's just another way to make some conclusions upon given data. If we have several values which are met with the same frequency we can conclude that distribution graph is meant to have several peaks. In other words by computing mode of mileage we can already say that the distribution graph of this value is meant to be multimodal. And if we go back to our mileage graph we will see that it's indeed multimodal.
  
  
```{r}
ggplot(df_cars, aes(km)) + geom_histogram(aes(y = ..density..)) + 
  geom_density(fill="#69b3a2", color="#e9ecef", alpha=0.2) +
  ggtitle("Distribution of car mileage") +
  theme_ipsum()
```
  
  

### Median values
#### Median of mileage
```{r  message=FALSE, warning=FALSE, echo=FALSE}

median(km)
```
#### Median of car age
```{r  message=FALSE, warning=FALSE, echo=FALSE}

median(years)
```
#### Median of rating
```{r  message=FALSE, warning=FALSE, echo=FALSE}

median(rating)
```
#### Median of condition rating
```{r  message=FALSE, warning=FALSE, echo=FALSE}

median(`condition rating`)
```
#### Median of given discount
```{r  message=FALSE, warning=FALSE, echo=FALSE}

median(discount)
```
#### Median of maximum speed
```{r  message=FALSE, warning=FALSE, echo=FALSE}

median(mph)
```
#### Median of torque
```{r  message=FALSE, warning=FALSE, echo=FALSE}

median(torque)
```
#### Median of price
```{r  message=FALSE, warning=FALSE, echo=FALSE}

median(price)
```
  
### Variabilty
#### Mileage
```{r}
Range(km)
IQR(km)
var(km)
```

  From the computations above we can say:
    - temperature of each star in the set lays in a range between 1939 and 40000 Kelvins
    - range between Q1 and Q3 equals 11711.25 which is approximately 1/3 of the whole range of values; 
    - variance or average squared difference of the scores from the mean equals 91248824


#### Car age
```{r}
Range(years)
IQR(years)
var(years)
```

  [DELETE]  
  From the computations above we can say:
    - luminosity of each star in the set lays in a range between 0.8 and 849420 lumens
    - range between Q1 and Q equals 198050
    - variance or average squared difference of the scores from the mean equals 32195930524 - it is a very big value which indicates that numbers in set are far from mean and far from each other **or** it might also state that there are some outlining values which add great weight to this number. 
    So let's `trim` luminosity and try again. By the way, we could have trimmed luminosity, temperature and radius sets in the very beginning as good practice, because those distributions have extremely skewed graphs.
    [DELETE]  
  
  [DELETE]  
```{r}
library(DescTools)
trim_lum <- Trim(stars_luminosity, trim = 0.30)
var(trim_lum)
```
   We removed 20% of lowest and greatest values and result is still a very large value what proves that deviations from mean are quite big for this parameter. 
     [DELETE]  

#### Discount
```{r}
Range(discount)
IQR(discount)
var(discount)
```  
 
  From the computations above we can say:
    - radius of each star in the set lays in a range between 0.0084 and 1948.5 
    - range between Q1 and Q3 equals 42.64725, compairing it o the main ramge we can conclude that major amount of records are below Q3
    - variance or average squared difference of the scores from the mean equals 267450.1 - it is a  big value too, but not in terms of this data set


#### Maximum speed
```{r}
Range(mph)
IQR(mph)
var(mph)
```    
    
  From the computations above we can say:
  - absolute magnitude of each star in the set lays in a range between -11.92 and 20.06 watts
  - range between Q1 and Q3 equals 19.93
  - variance or average squared difference of the scores from the mean equals 110.9338 - it is a small value comparing to previous one, but if we take range into consideration we can say, that spread of values is quite unbalanced too.
  
#### Torque
```{r}
Range(torque)
IQR(torque)
var(torque)
``` 
  [CONCLUSIONS]

  [CONCLUSIONS]

#### Price
```{r}
Range(price)
IQR(price)
var(price)
```   

  
---
# Part 3
  
  In this part we will explore some dependencies between known parameters of the stars in our dataset. 
  Let's choose one parameter which we will target in this part of work. This parameter will be out dependent value, which means we will explore how and how much it is influenced by other parameters. 
  **Magnitude** is going to be such parameter. It means we will investigate what magnitude consists of.

  
## Correlations and correlation matrix
  
  Purpose of this computation is to find what values might be depended from each other.
  
```{r}
library(dplyr)

cars_cor <- cor(cars)

library(corrplot)

corrplot(cars_cor, method ="pie", type="lower")
```
  
  
  As we can see observe from the correlation matrix above, the highest correlation is between magnitude-luminosity pair, we can say that this values are connected and assume (but not be sure) that they have cause-effect relationship. Their correlation coefficient is negative which means that with the growth of one parameter the other one lowers simultaneously. The highest positive correlation we can see in radius-luminosity pair. On the matrix we can see that they tend to grow synchronously. 
  Let's take those three pairs into further steps and build scatter plots for them..
  
```{r}
library(ggplot2)
library(DescTools)

ggplot(cars, aes(x = km, y = price)) + geom_point()


```

  
  
  
  
  
  
  
  
  
  
  
