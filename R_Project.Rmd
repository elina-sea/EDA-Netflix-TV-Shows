---
title: "EDA on 240 Stars Among 5 Star Types"
output:
  html_document:
    df_print: paged
editor_options: 
  chunk_output_type: inline
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

---
# Part 1

  This is an R Notebook containing the analysis of different parameters of set of 240 stars. Data set was obtained from [Kaggle](https://www.kaggle.com/deepu1109/star-dataset).
  Stars are divided into the following 6 classes:

  - Brown Dwarf -> Star Type = 0
  - Red Dwarf -> Star Type = 1
  - White Dwarf-> Star Type = 2
  - Main Sequence -> Star Type = 3
  - Supergiant -> Star Type = 4
  - Hypergiant -> Star Type = 5
  
  Let's start with observing what types of variables there are in this data set:

```{r echo = FALSE}
library(readr)
library(ggplot2)
#read in the dataset
stars <- read_csv("Stars.csv")
```

  As we can observe this data set has majorly quantitative variables: `temperature measured in Kelvins, luminosity (with respect to Sun), radius (with respect to Sun), absolute visual magnitude, star type` and minorly of qualitative variables: `star color, spectral class`.
  
#### Reasoning for using this data set
  Some of the tasks to be performed and aspects to be explored:
  
### Analysing missing values 

```{r message=FALSE, paged.print=FALSE, echo=FALSE}
library(VIM)
library(naniar)
#plot missing values with naniar pkg which is based on ggplot2
gg_miss_var(stars)
#plot proportions of missing values and their combos with vim aggr 
summary(aggr(stars))
```

  As we can see, there are no missing values in this data set. Which means we can assume that all relations will be reliable.
  
## Now let's have fun and explore distribution of each parameter individually

  On the following graphs distribution of each parameter among all star types is shown.
  
  
```{r message=FALSE, warning=FALSE, echo=FALSE}
library(cowplot)

stars_temperature <- c(stars$`Temperature (K)`)
stars_luminosity <- c(stars$`Luminosity(L/Lo)`)
stars_radius <- c(stars$`Radius(R/Ro)`)
stars_magnitute_absolute <- c(stars$`Absolute magnitude(Mv)`)
stars_type <- c(stars$`Star type`)

df_stars <- data.frame(stars)

p_temp <- ggplot(df_stars, aes(stars_temperature)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_lum <- ggplot(df_stars, aes(stars_luminosity)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_rad <- ggplot(df_stars, aes(stars_radius)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_magn <- ggplot(df_stars, aes(stars_magnitute_absolute)) + geom_histogram(aes(y = ..density..)) + geom_density()

plot_grid(p_temp, p_lum, p_rad, p_magn)


```
 
 
  But let's remember that there are 6 types of stars in the dataset. Let's see how all 240 stars are distributed among those types.
  
  
  
```{r message=FALSE, warning=FALSE, echo=FALSE}

star_type <- c(stars$`Star type`)
p_type <- ggplot(df_stars, aes(star_type)) + geom_histogram(aes(y = ..density..)) + geom_density()
show(p_type)

```
 
 
  From the plot above we can conclude that there's an even amount of each star type presented in data set. But does it mean that all of the distributions we explored earlier (temperature, luminosity, radius, magnitude) will remain the same in terms of every type individually?
Let's find out.

```{r message=FALSE, warning=FALSE, echo=FALSE}
#TYPE O
stype0 <- stars[stars$`Star type`=="0",]

df_stype0 <- data.frame(stype0, stringsAsFactors=FALSE)

stype0_temperature <- c(stype0$`Temperature (K)`)
stype0_luminosity <- c(stype0$`Luminosity(L/Lo)`)
stype0_radius <- c(stype0$`Radius(R/Ro)`)
stype0_magnitute_absolute <- c(stype0$`Absolute magnitude(Mv)`)

p_temp_stype0 <- ggplot(df_stype0, aes(stype0_temperature)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_lum_stype0 <- ggplot(df_stype0, aes(stype0_luminosity)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_rad_stype0 <- ggplot(df_stype0, aes(stype0_radius)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_magn_stype0 <- ggplot(df_stype0, aes(stype0_magnitute_absolute)) + geom_histogram(aes(y = ..density..)) + geom_density()


#TYPE 1
stype1 <- stars[stars$`Star type`=="1",]

df_stype1 <- data.frame(stype1)

stype1_temperature <- c(stype1$`Temperature (K)`)
stype1_luminosity <- c(stype1$`Luminosity(L/Lo)`)
stype1_radius <- c(stype1$`Radius(R/Ro)`)
stype1_magnitute_absolute <- c(stype1$`Absolute magnitude(Mv)`)

p_temp_stype1 <- ggplot(df_stype1, aes(stype1_temperature)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_lum_stype1 <- ggplot(df_stype1, aes(stype1_luminosity)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_rad_stype1 <- ggplot(df_stype1, aes(stype1_radius)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_magn_stype1 <- ggplot(df_stype1, aes(stype1_magnitute_absolute)) + geom_histogram(aes(y = ..density..)) + geom_density()


#TYPE 2
stype2 <- stars[stars$`Star type`=="2",]

df_stype2 <- data.frame(stype2)

stype2_temperature <- c(stype2$`Temperature (K)`)
stype2_luminosity <- c(stype2$`Luminosity(L/Lo)`)
stype2_radius <- c(stype2$`Radius(R/Ro)`)
stype2_magnitute_absolute <- c(stype2$`Absolute magnitude(Mv)`)

p_temp_stype2 <- ggplot(df_stype2, aes(stype2_temperature)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_lum_stype2 <- ggplot(df_stype2, aes(stype2_luminosity)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_rad_stype2 <- ggplot(df_stype2, aes(stype2_radius)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_magn_stype2 <- ggplot(df_stype2, aes(stype2_magnitute_absolute)) + geom_histogram(aes(y = ..density..)) + geom_density()


#TYPE 3
stype3 <- stars[stars$`Star type`=="3",]

df_stype3 <- data.frame(stype3)

stype3_temperature <- c(stype3$`Temperature (K)`)
stype3_luminosity <- c(stype3$`Luminosity(L/Lo)`)
stype3_radius <- c(stype3$`Radius(R/Ro)`)
stype3_magnitute_absolute <- c(stype3$`Absolute magnitude(Mv)`)

p_temp_stype3 <- ggplot(df_stype3, aes(stype3_temperature)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_lum_stype3 <- ggplot(df_stype3, aes(stype3_luminosity)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_rad_stype3 <- ggplot(df_stype3, aes(stype3_radius)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_magn_stype3 <- ggplot(df_stype3, aes(stype3_magnitute_absolute)) + geom_histogram(aes(y = ..density..)) + geom_density()


#TYPE 4
stype4 <- stars[stars$`Star type`=="4",]

df_stype4 <- data.frame(stype4)

stype4_temperature <- c(stype4$`Temperature (K)`)
stype4_luminosity <- c(stype4$`Luminosity(L/Lo)`)
stype4_radius <- c(stype4$`Radius(R/Ro)`)
stype4_magnitute_absolute <- c(stype4$`Absolute magnitude(Mv)`)

p_temp_stype4 <- ggplot(df_stype4, aes(stype4_temperature)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_lum_stype4 <- ggplot(df_stype4, aes(stype4_luminosity)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_rad_stype4 <- ggplot(df_stype4, aes(stype4_radius)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_magn_stype4 <- ggplot(df_stype4, aes(stype4_magnitute_absolute)) + geom_histogram(aes(y = ..density..)) + geom_density()


#TYPE 5
stype5 <- stars[stars$`Star type`=="5",]

df_stype5 <- data.frame(stype5)

stype5_temperature <- c(stype5$`Temperature (K)`)
stype5_luminosity <- c(stype5$`Luminosity(L/Lo)`)
stype5_radius <- c(stype5$`Radius(R/Ro)`)
stype5_magnitute_absolute <- c(stype5$`Absolute magnitude(Mv)`)

p_temp_stype5 <- ggplot(df_stype5, aes(stype5_temperature)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_lum_stype5 <- ggplot(df_stype5, aes(stype5_luminosity)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_rad_stype5 <- ggplot(df_stype5, aes(stype5_radius)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_magn_stype5 <- ggplot(df_stype5, aes(stype5_magnitute_absolute)) + geom_histogram(aes(y = ..density..)) + geom_density()


plot_grid(p_temp_stype0, p_temp_stype1, p_temp_stype2, p_temp_stype3, p_temp_stype4, p_temp_stype5)
plot_grid(p_lum_stype0, p_lum_stype1, p_lum_stype2, p_lum_stype3, p_lum_stype4, p_lum_stype5)
plot_grid(p_rad_stype0, p_rad_stype1, p_rad_stype2, p_rad_stype3, p_rad_stype4, p_rad_stype5)
plot_grid(p_magn_stype0, p_magn_stype1, p_magn_stype2, p_magn_stype3, p_magn_stype4, p_magn_stype5)

```


  But let's not forget that we also have stars divided according to their spectral class - not only types. 
  How many stars are represented in each spectral class? Let's see:


```{r message=FALSE, warning=FALSE, echo=FALSE}
library(ggplot2)

sclassO <- stars[stars$`Spectral Class` == "O",]
sclassB <- stars[stars$`Spectral Class` == "B",]
sclassA <- stars[stars$`Spectral Class` == "A",]
sclassF <- stars[stars$`Spectral Class` == "F",]
sclassG <- stars[stars$`Spectral Class` == "G",]
sclassK <- stars[stars$`Spectral Class` == "K",]
sclassM <- stars[stars$`Spectral Class` == "M",]

sclassO_value <- nrow(sclassO)
sclassB_value <- nrow(sclassB)
sclassA_value <- nrow(sclassA)
sclassF_value <- nrow(sclassF)
sclassG_value <- nrow(sclassG)
sclassK_value <- nrow(sclassK)
sclassM_value <- nrow(sclassM) 

all_classes <- c(sclassO_value, sclassB_value, sclassA_value, sclassF_value, sclassG_value, sclassK_value, sclassM_value)

show(all_classes)

```
```
Class
        O   B   A   F   G   K   M
  
```
  
  Let's also observe how previously examined parameters are distributed in terms of each class:
  
```{r message=FALSE, warning=FALSE, echo=FALSE}
library(cowplot)

#CLASS O
df_scalssO <- data.frame(sclassO)

sclassO_temperature <- c(sclassO$`Temperature (K)`)
sclassO_luminosity <- c(sclassO$`Luminosity(L/Lo)`)
sclassO_radius <- c(sclassO$`Radius(R/Ro)`)
sclassO_magnitute_absolute <- c(sclassO$`Absolute magnitude(Mv)`)

p_temp_sclassO <- ggplot(df_scalssO, aes(sclassO_temperature)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_lum_sclassO <- ggplot(df_scalssO, aes(sclassO_luminosity)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_rad_sclassO <- ggplot(df_scalssO, aes(sclassO_radius)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_magn_sclassO <- ggplot(df_scalssO, aes(sclassO_magnitute_absolute)) + geom_histogram(aes(y = ..density..)) + geom_density()

#CLASS B
df_scalssB <- data.frame(sclassB)

sclassB_temperature <- c(sclassB$`Temperature (K)`)
sclassB_luminosity <- c(sclassB$`Luminosity(L/Lo)`)
sclassB_radius <- c(sclassB$`Radius(R/Ro)`)
sclassB_magnitute_absolute <- c(sclassB$`Absolute magnitude(Mv)`)

p_temp_sclassB <- ggplot(df_scalssB, aes(sclassB_temperature)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_lum_sclassB <- ggplot(df_scalssB, aes(sclassB_luminosity)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_rad_sclassB <- ggplot(df_scalssB, aes(sclassB_radius)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_magn_sclassB <- ggplot(df_scalssB, aes(sclassB_magnitute_absolute)) + geom_histogram(aes(y = ..density..)) + geom_density()

#CLASS A
df_scalssA <- data.frame(sclassA)

sclassA_temperature <- c(sclassA$`Temperature (K)`)
sclassA_luminosity <- c(sclassA$`Luminosity(L/Lo)`)
sclassA_radius <- c(sclassA$`Radius(R/Ro)`)
sclassA_magnitute_absolute <- c(sclassA$`Absolute magnitude(Mv)`)

p_temp_sclassA <- ggplot(df_scalssA, aes(sclassA_temperature)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_lum_sclassA <- ggplot(df_scalssA, aes(sclassA_luminosity)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_rad_sclassA <- ggplot(df_scalssA, aes(sclassA_radius)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_magn_sclassA <- ggplot(df_scalssA, aes(sclassA_magnitute_absolute)) + geom_histogram(aes(y = ..density..)) + geom_density()

#CLASS F
df_scalssF <- data.frame(sclassF)

sclassF_temperature <- c(sclassF$`Temperature (K)`)
sclassF_luminosity <- c(sclassF$`Luminosity(L/Lo)`)
sclassF_radius <- c(sclassF$`Radius(R/Ro)`)
sclassF_magnitute_absolute <- c(sclassF$`Absolute magnitude(Mv)`)

p_temp_sclassF <- ggplot(df_scalssF, aes(sclassF_temperature)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_lum_sclassF <- ggplot(df_scalssF, aes(sclassF_luminosity)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_rad_sclassF <- ggplot(df_scalssF, aes(sclassF_radius)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_magn_sclassF <- ggplot(df_scalssF, aes(sclassF_magnitute_absolute)) + geom_histogram(aes(y = ..density..)) + geom_density()

#CLASS G
df_scalssG <- data.frame(sclassG)

sclassG_temperature <- c(sclassG$`Temperature (K)`)
sclassG_luminosity <- c(sclassG$`Luminosity(L/Lo)`)
sclassG_radius <- c(sclassG$`Radius(R/Ro)`)
sclassG_magnitute_absolute <- c(sclassG$`Absolute magnitude(Mv)`)

p_temp_sclassG <- ggplot(df_scalssG, aes(sclassG_temperature)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_lum_sclassG <- ggplot(df_scalssG, aes(sclassG_luminosity)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_rad_sclassG <- ggplot(df_scalssG, aes(sclassG_radius)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_magn_sclassG <- ggplot(df_scalssG, aes(sclassG_magnitute_absolute)) + geom_histogram(aes(y = ..density..)) + geom_density()

#CLASS K
df_scalssK <- data.frame(sclassK)

sclassK_temperature <- c(sclassK$`Temperature (K)`)
sclassK_luminosity <- c(sclassK$`Luminosity(L/Lo)`)
sclassK_radius <- c(sclassK$`Radius(R/Ro)`)
sclassK_magnitute_absolute <- c(sclassK$`Absolute magnitude(Mv)`)

p_temp_sclassK <- ggplot(df_scalssK, aes(sclassK_temperature)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_lum_sclassK <- ggplot(df_scalssK, aes(sclassK_luminosity)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_rad_sclassK <- ggplot(df_scalssK, aes(sclassK_radius)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_magn_sclassK <- ggplot(df_scalssK, aes(sclassK_magnitute_absolute)) + geom_histogram(aes(y = ..density..)) + geom_density()

#CLASS M
df_scalssM <- data.frame(sclassM)

sclassM_temperature <- c(sclassM$`Temperature (K)`)
sclassM_luminosity <- c(sclassM$`Luminosity(L/Lo)`)
sclassM_radius <- c(sclassM$`Radius(R/Ro)`)
sclassM_magnitute_absolute <- c(sclassM$`Absolute magnitude(Mv)`)

p_temp_sclassM <- ggplot(df_scalssM, aes(sclassM_temperature)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_lum_sclassM <- ggplot(df_scalssM, aes(sclassM_luminosity)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_rad_sclassM <- ggplot(df_scalssM, aes(sclassM_radius)) + geom_histogram(aes(y = ..density..)) + geom_density()
p_magn_sclassM <- ggplot(df_scalssM, aes(sclassM_magnitute_absolute)) + geom_histogram(aes(y = ..density..)) + geom_density()

#PLOT
plot_grid(p_temp_sclassO, p_temp_sclassB, p_temp_sclassA, p_temp_sclassF, p_temp_sclassG, p_temp_sclassK, p_temp_sclassM)
plot_grid(p_lum_sclassO, p_lum_sclassB, p_lum_sclassA, p_lum_sclassF, p_lum_sclassG, p_lum_sclassK, p_lum_sclassM)
plot_grid(p_rad_sclassO, p_rad_sclassB, p_rad_sclassA, p_rad_sclassF, p_rad_sclassG, p_rad_sclassK, p_rad_sclassM)
plot_grid(p_magn_sclassO, p_magn_sclassB, p_magn_sclassA, p_magn_sclassF, p_magn_sclassG, p_magn_sclassK, p_magn_sclassM)
```
  
  
  All class-G graphs seem to be a bit off but the reason for it is that just one star been assigned that class.
  
## Summary on distribution graphs

  Among more than 50 graphs above we can observe all kinds of distributions: distinct positive skewed ones (like stype2_luminosity and stype3_luminosity); negative skewed (like sclassM_magnitute_absolute); and almost bell-shaped (aka normal) distribution on graph stype5_radius.
  
  
  
  
  
  
  
  
